data <- read_csv('c1.csv')
require(dplyr)
require(tidyverse)
require(stringr)
require(reshape2)
data <- read_csv('c1.csv')
data
data <- read_csv('c1.csv') %>% select(Fecha, ID, Camion = Camion_5)
data <- read_csv('c1.csv')
data
data <- read_csv('c1.csv') select(Fecha, ID, camion = Camion_5,pickup = Pickup,moto = Moto, cod = Cod, origen, Lat, Long, factura,
data <- read_csv('c1.csv') %>%  select(Fecha, ID, camion = Camion_5,pickup = Pickup,moto = Moto, cod = Cod, origen, Lat, Long, factura,
variable_camion = directoCamion_5, variable_pickup = directoPickup, variable_moto = directoMoto,
fijo_camion = fijoCamion_5, fijo_pickup = fijoPickup, fijo_moto = fijoMoto, height, `5-30`,`30-45`,
`45-75`,`75-120`,`120+`)
data
data$camion <- substr(data$camion,2)
data$camion <- substring(data$camion,2)
data
require(dplyr)
require(tidyverse)
require(stringr)
require(reshape2)
require(lubridate)
data <- read_csv('c1.csv') %>%  select(Fecha, ID, camion = Camion_5,pickup = Pickup,moto = Moto, cod = Cod, origen, Lat, Long, factura,
variable_camion = directoCamion_5, variable_pickup = directoPickup, variable_moto = directoMoto,
fijo_camion = fijoCamion_5, fijo_pickup = fijoPickup, fijo_moto = fijoMoto, height, `5-30`,`30-45`,
`45-75`,`75-120`,`120+`)
data$camion <- substring(data$camion,2)
data$pickup <- substring(data$pickup,2)
data$moto <- substring(data$moto,2)
data$factura <- substring(data$factura,2)
data$variable_camion <- substring(data$variable_camion,2)
data$variable_moto <- substring(data$variable_moto,2)
data$variable_pickup <- substring(data$variable_pickup,2)
data$fijo_camion <- substring(data$fijo_camion,2)
data$fijo_moto <- substring(data$fijo_moto,2)
data$fijo_pickup <- substring(data$fijo_pickup,2)
for(x in c("camion","moto","pickup","factura","variable_camion","variable_moto","variable_pickup","fijo_camion","fijo_moto","fijo_pickup")){
data[data[[x]] == "-",x] <- 0
data[x] <- as.numeric(data[[x]])
}
tidy_function_1 <- function(x){
if(x[3] > 0){
return(as.character("Camion"))
} else if(x[4] > 0){
return(as.character("Pickup"))
} else if(x[5] > 0){
return(as.character("Moto"))
}
}
tidy_function_2 <- function(x){
if(x[3] > 0){
return(as.numeric(x[3]))
} else if(x[4] > 0){
return(as.numeric(x[4]))
} else if(x[5] > 0){
return(as.numeric(x[5]))
}
}
data$vehiculo <- apply(data,1,tidy_function_1)
data$vehiculo <- apply(data,1,tidy_function_1)
data$costo_total <- apply(data,1,tidy_function_2)
data$costo_total <- apply(data,1,tidy_function_2)
tidy_function_3 <- function(x){
if(x[3] > 0){
return(as.numeric(x[11]))
} else if(x[4] > 0){
return(as.numeric(x[12]))
} else if(x[5] > 0){
return(as.numeric(x[13]))
}
}
tidy_function_4 <- function(x){
if(x[3] > 0){
return(as.numeric(x[14]))
} else if(x[4] > 0){
return(as.numeric(x[15]))
} else if(x[5] > 0){
return(as.numeric(x[16]))
}
}
data$costo_variable <- apply(data,1,tidy_function_3)
data$costo_variable <- apply(data,1,tidy_function_3)
data$costo_fijo <- apply(data,1,tidy_function_4)
data$costo_fijo <- apply(data,1,tidy_function_4)
tidy_function_5 <- function(x){
if(!is.na(x[18] == "x")){
return("5-30")
} else if(!is.na(x[19] == "x")){
return("30-45")
} else if(!is.na(x[20] == "x")){
return("45-75")
} else if(!is.na(x[21] == "x")){
return("75-120")
} else if(!is.na(x[22] == "x")){
return("120+")
}
}
data$minutos <- apply(data,1,tidy_function_5)
data$Fecha <- dmy(data$Fecha)
data <- data %>%
select(Fecha, ID,cod,origen,Lat,Long,vehiculo,minutos,factura,costo_total,costo_fijo,costo_variable)
#estado_de_resultados
ingresos_totales <- c()
costos_totales <- c()
for(x in c(unique(data$cod),"total")){
if(x != "total"){
ingresos <- sum(data[data$cod == x,"factura"])
ingresos_totales <- c(ingresos_totales, ingresos)
print(paste("Ingresos por",x,": Q.",format(ingresos, big.mark = ",", scientific = FALSE, trim = TRUE)))
} else if(x == "total"){
print("----------------------------------------------------------------------------")
print(paste("Ingresos totales por servicios: Q.", format(sum(ingresos_totales),big.mark = ",", scientific = FALSE, trim = TRUE)))
}
}
for(x in c(unique(data$cod),"total")){
if(x != "total"){
costo_de_ventas <- sum(data[data$cod == x,"costo_variable"])
costos_totales <- c(costos_totales,costo_de_ventas)
print(paste("Costo de ventas por",x,": ( Q.",format(costo_de_ventas, big.mark = ",", scientific = FALSE, trim = TRUE),")"))
} else if(x == "total"){
print("--------------------------------------------------------------------------------------------------------")
print(paste("Utilidad bruta : Q.", format(sum(ingresos_totales - costos_totales), big.mark = ",", scientific = FALSE, trim = TRUE)))
print(paste("Costos fijos: -Q.", format(sum(data["costo_fijo"]), big.mark = ",", scientific = FALSE, trim = TRUE)))
print("--------------------------------------------------------------------------------------------------------")
print(paste("Utilidad antes de intereses, depreciaciones, amortizaciones e impuestos (EBIDTA): Q.", format(sum(ingresos_totales - costos_totales) - sum(data["costo_fijo"]), big.mark = ",", scientific = FALSE, trim = TRUE)))
}
}
#estado_de_resultados
ingresos_totales <- c()
costos_totales <- c()
for(x in c(unique(data$cod),"total")){
if(x != "total"){
ingresos <- sum(data[data$cod == x,"factura"])
ingresos_totales <- c(ingresos_totales, ingresos)
print(paste("Ingresos por",x,": Q.",format(ingresos, big.mark = ",", scientific = FALSE, trim = TRUE)))
} else if(x == "total"){
print("--------------------------------------------------------------------------------------------------------")
print(paste("Ingresos totales por servicios: Q.", format(sum(ingresos_totales),big.mark = ",", scientific = FALSE, trim = TRUE)))
}
}
for(x in c(unique(data$cod),"total")){
if(x != "total"){
costo_de_ventas <- sum(data[data$cod == x,"costo_variable"])
costos_totales <- c(costos_totales,costo_de_ventas)
print(paste("Costo de ventas por",x,": ( Q.",format(costo_de_ventas, big.mark = ",", scientific = FALSE, trim = TRUE),")"))
} else if(x == "total"){
print("--------------------------------------------------------------------------------------------------------")
print(paste("Utilidad bruta : Q.", format(sum(ingresos_totales - costos_totales), big.mark = ",", scientific = FALSE, trim = TRUE)))
print(paste("Costos fijos: -Q.", format(sum(data["costo_fijo"]), big.mark = ",", scientific = FALSE, trim = TRUE)))
print("--------------------------------------------------------------------------------------------------------")
print(paste("Utilidad antes de intereses, depreciaciones, amortizaciones e impuestos (EBIDTA): Q.", format(sum(ingresos_totales - costos_totales) - sum(data["costo_fijo"]), big.mark = ",", scientific = FALSE, trim = TRUE)))
}
}
data
require(ggplot2)
ggplot(data, aes(x = Long, y = Lat)) +
geom_point()
ggplot(data, aes(x = log(Long), y = log(Lat))) +
geom_point(aes = origen)
ggplot(data, aes(x = log(Long), y = log(Lat))) +
geom_point(aes = color(origen))
ggplot(data, aes(x = log(Long), y = log(Lat))) +
geom_point(aes = (color = (origen)))
ggplot(data, aes(x = log(Long), y = log(Lat))) +
geom_point(aes(color = factor(origen)))
ggplot(data, aes(x = (Long), y = (Lat))) +
geom_point(aes(color = factor(origen)))
data$dif_precios <- data$factura - data$costo_total
data
data <- data %>%
select(Fecha, ID,cod,vehiculo,minutos,factura,costo_total,costo_fijo,costo_variable)
data$dif_precios <- data$factura - data$costo_total
data
data$%_precios <- (data$factura - data$costo_total)/data$costo_total
data$porcentaje_precios <- (data$factura - data$costo_total)/data$costo_total
data
tarifario <- data %>%
select(cod, vehiculo, factura) %>%
group_by(vehiculo,cod) %>%
summarise(promedio = mean(factura))
tarifario
tarifario <- data %>%
select(cod, vehiculo, factura) %>%
group_by(vehiculo,cod) %>%
summarise(costo_promedio = mean(factura)) %>%
order_by(vehiculo,costo_promedio)
tarifario <- data %>%
select(cod, vehiculo, factura) %>%
group_by(vehiculo,cod) %>%
summarise(costo_promedio = mean(factura)) %>%
order_by(vehiculo)
tarifario <- data %>%
select(cod, vehiculo, factura) %>%
group_by(vehiculo,cod) %>%
summarise(costo_promedio = mean(factura)) %>%
order_by(desc(vehiculo,costo_promedio))
tarifario <- data %>%
select(cod, vehiculo, factura) %>%
group_by(vehiculo,cod) %>%
summarise(costo_promedio = mean(factura))
tarifario
tarifario <- data %>%
select(cod, vehiculo, factura) %>%
group_by(vehiculo,cod) %>%
summarise(costo_promedio = mean(factura)) %>%
order_by(desc(costo_promedio))
tarifario <- data %>%
select(cod, vehiculo, factura) %>%
group_by(vehiculo,cod) %>%
summarise(costo_promedio = mean(factura)) %>%
arrange(desc(camion,costo_promedio))
tarifario <- data %>%
select(cod, vehiculo, factura) %>%
group_by(vehiculo,cod) %>%
summarise(costo_promedio = mean(factura)) %>%
arrange(desc(vehiculo,costo_promedio))
tarifario
tarifario <- data %>%
select(cod, vehiculo, factura) %>%
group_by(vehiculo,cod) %>%
summarise(costo_promedio = mean(factura)) %>%
arrange(desc(costo_promedio), .by_group = TRUE)
tarifario
contratos_mensuales <- data %>%
select(Fecha, ID) %>%
group_by(month(Fecha)) %>%
summarise(ventas = n()) %>%
arrange(desc(month(Fecha)))
data
contratos_mensuales <- data %>%
select(month(Fecha), ID) %>%
group_by(month(Fecha)) %>%
summarise(ventas = n()) %>%
arrange(desc(month(Fecha)))
